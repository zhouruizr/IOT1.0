@using DataProvider.Models
@using DataProvider.Paging

  
     <link href="~/CSS/common.css" rel="stylesheet" />
    <link href="http://m.525j.com.cn/css/wxshare.css" rel="stylesheet" type="text/css" />
<link href="~/CSS/quotation.css" rel="stylesheet" />

    <style>
        body {
            background: #f5f5f9;
        }

        .w640 {
            max-width: 640px;
            min-width: 320px;
            margin: 0 auto;
            overflow: hidden;
            overflow-x: hidden;
            overflow-x: hidden !important;
        }

        .w600 {
            width: 93.75%;
            margin: 0 auto;
            overflow: hidden;
        }

        .w640 img {
            width: 100%;
            height: auto;
        }
#quotation{
	padding-top: 0px;
}
    .calculatecon .remark {
	position: absolute;
	left: 22.5%;
	top: 50%;
	width: 77%;
	padding: 0.2rem 0;
	color: #999999;
    font-size: 0.75rem;
    border: none;
    -webkit-transform: translateY(-50%);
    transform: translateY(-50%);
}
    .calculatecon .line .selectBox{

  width: 50%; 

}
        </style>
    



    <script src="http://m.525j.com.cn/Scripts/jquery-1.7.1.min.js"></script>
    <script src="http://m.525j.com.cn/js/cityjson.js" charset="utf-8"></script>
    <script src="http://m.525j.com.cn/js/layer/layer.mobile.js"></script>




    <section class="w640 pab375">


        <div id="quotation" class="w640">
            <div class="top">
               <img src="~/Images/backgrounds/wx_20170527160338.jpg" />
            </div>
            <div class="baojia">
                <div class="messages">
                    <div class="inner">
                        最新的<span>暑期班</span>已经开始报名了，赶紧来加入吧！
                    </div>
                </div>
                <div class="calculatecon">
                    <div class="line">
                        <div class="l_box clearfloat">
                            <label>您的姓名</label>
                            <input class="name" type="text">
                        </div>
                    </div>
                    <div class="line">
                        <div class="l_box clearfloat">
                            <label>您的手机</label>
                            <input class="phone" type="tel">
                        </div>
                    </div>

                    <div class="line level">
                        <div class="l_box clearfloat">
                            <label>参与课程</label>
                            <div class="selectBox select_type" style="">
                                <select></select>
                            </div>
                        </div>
                    </div>
                    <div class="line clearfloat">
                        <div class="l_box clearfloat">
                            <label>您的留言</label>
                            <textarea class="remark" type="text" style="height:100%;"></textarea>
                        </div>
                    </div>
                </div>
                <button class="getBtn">马上预约/咨询</button>
            </div>

            <div class="shadow"></div>
            <div class="shadow2"></div>
        </div>
        <div class="alert">
            <p>请输入正确的手机号码</p>
            <a href="javascript:void(0);">确定</a>
        </div>





        <script src="http://m.525j.com.cn/js/commFun.js"></script>
        <script src="http://m.525j.com.cn/Scripts/jquery.unobtrusive-ajax.min.js"></script>
        <script src="http://m.525j.com.cn/Scripts/jquery.validate.min.js"></script>
        <script src="http://m.525j.com.cn/Scripts/jquery.validate.unobtrusive.min.js"></script>

        <!-- <script type="text/javascript" src="http://www.525j.com.cn/corp/scripts/business/CommonApply.js" charset="utf-8"></script> -->
        <script type="text/javascript" src="http://www.525j.com.cn/corp/scripts/business/CommonApplyNew.js" charset="utf-8"></script>
        <script type="text/javascript" src="http://m.525j.com.cn/js/quotation.js"></script>


        <div style="display:none">
            <script type="text/javascript">
                var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
                document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fb4b6a874a15ad81bfa57485d403c1a7f' type='text/javascript'%3E%3C/script%3E"));
            </script>


            <script src="http://m.525j.com.cn/js/jquery.flexslider-min.js" type="text/javascript"></script>
            <script src="http://m.525j.com.cn/js/Marquee-min.js" type="text/javascript"></script>

            <script src="http://m.525j.com.cn/js/Popup.js"></script>

        </div>
    </section>

    <!--选择城市-->
    <!--选择城市height:100%; -->



    <style type="text/css">


/*头部*/

.headerCity {
    height: 2.78125em;
    position: fixed;
    width: 100%;
    margin: 0 auto;
    left: 0;
    top: 0;
    right: 0;
    z-index: 222;
    margin: 0 auto;
    background: #ffffff;
    margin: 0 auto;
    border-bottom: 1px solid #ececec;
}
.headerCity h1 { line-height: 2.933em; text-align: center; font-size: 0.9375em; color: #333333; font-weight:normal;}
.headerCity .city_top{position: absolute; left:1em; top: 0.875em; z-index:222; line-height:1;}
.headerCity .city_top .logo {text-indent: -9999em; width: 0.5625em; height: 1.03125em; overflow: hidden; background: url(/images/city/leftbg.png) no-repeat; background-size: 100% 100%; -moz-background-size: 100% 100%; -webkit-background-size: 100% 100%; display:block; float:left;}
.headerCity .city_top span{ color:#333333; font-size:0.75em; display:block; height:1.375em; line-height:1.375em; margin-left:0.5em; float:left;}
/*头部*/

.cityCon{ width:100%; z-index:1; position:relative;}
.cityCon.topone{ margin-top:2.78125em;}
.cityCon h2.h2_tit{ color:#999999; font-size:0.75em; text-indent:0.833em; height:2.625em; line-height:2.625em; font-weight:normal;}
.cityCon h2.h2_tit span{ padding-right:0.5em;}
.cityCon .mentCon{ background:#fff; height:2.8125em;  border-bottom: 1px solid #ececec; border-top: 1px solid #ececec;}
.cityCon .mentCon p{ color:#e72f17; padding-left:1.375em;line-height:2.75em;}
.cityCon .mentCon p span{ font-size:0.75em;}

/*热门城市*/
.cityCon .ment_re{background:#fff; border-bottom: 1px solid #ececec; border-top: 1px solid #ececec;}
.ment_re .re_lie{ border-bottom: 1px solid #ececec;}
.ment_re .re_lie.bot{ border-bottom:none;}
.ment_re .re_lie a{ display:block; float:left; width:33%; font-size:0.875em; color:#333333; text-align:center; height:3.14285em; line-height:3.14285em;border-right: 1px solid #ececec;}
.ment_re .re_lie a:nth-of-type(3n) { border-right:none;width:34%;}
.ment_re .re_lie a.acurr{ background:#f5f5f5;}
/*字母排列*/
.cityCon .ment_zi{background:#fff; border-top: 1px solid #ececec;}
.ment_zi .zi_lie{ border-bottom: 1px solid #ececec;}
.ment_zi .zi_lie.bot{ border-bottom:none;}
.ment_zi .zi_lie a {
    display: block;
    float: left;
    width: 20%;
    font-size: 0.875em;
    color: #333333;
    border-bottom: 1px solid #ececec; text-align:center;
    height: 3.14285em;
    line-height: 3.14285em;
    border-right: 1px solid #ececec;
}
.ment_zi .zi_lie a.acurr{ background:#f5f5f5;}

.ment_zi .zi_lie a:nth-of-type(5n) { border-right:none;}


/*返回顶部*/
.redBag02{ position: fixed;bottom: 5em;left: 0;z-index: 200;width: 100%; display:none; }
.redBag02 .inner{ position: relative;margin: 0 auto; max-width: 640px; min-width: 320px; }
.redBag02 .inner div{ position: absolute;right: 4.375%;bottom: 0;width: 13.75%;cursor: pointer; }

    </style>




    <!--end 选择城市-->
    <script type="text/javascript">


      var packageOnly = false;
    var canReload = false; //切换城市后是否需要重定向
    var selectedCallBack;
    var selectCity = {
        Province: "",
        Provinceid: "",
        City: "",
        Cityid: "",
        CitySpel: ""
    };

    //弹层操作
    function popHandleCity() {
        var a_fenx = $(".cityb a"),
            city_fu_hui = $(".city_fu_hui"),
            closeBtn_fen = $(".city_fu_hui .city_top");

        closeBtn_fen.on("click", function () {
            city_fu_hui.removeClass("show").addClass("hide");
        });
    }
    //滚动效果

    function touchCon() {
        var touchEvents = {
            touchstart: "touchstart",
            touchmove: "touchmove",
            touchend: "touchend",
        };
        $(".ment_re a").bind(touchEvents.touchstart, function (event) {
            $(this).addClass("acurr");
            //event.preventDefault();

        });
        $(".ment_re a").bind(touchEvents.touchmove, function (event) {
            $(this).removeClass("acurr");

        });
        $(".ment_re a").bind(touchEvents.touchend, function (event) {
            $(this).removeClass("acurr");
            // event.preventDefault();

        });
        $(".ment_zi a").bind(touchEvents.touchstart, function (event) {
            $(this).addClass("acurr");
            //event.preventDefault();

        });
        $(".ment_zi a").bind(touchEvents.touchmove, function (event) {
            $(this).removeClass("acurr");

        });
        $(".ment_zi a").bind(touchEvents.touchend, function (event) {
            $(this).removeClass("acurr");
            //  event.preventDefault();

        });

    }

    //滚动效果
    function scrollCityCon() {

        //返回顶部显示隐藏
        var $body = $(window).height();
        $(".city_fu_hui .outer").on("scroll", function () {
            //$(".headerCity").css({ "top": $(this).scrollTop() });

            if ($(this).scrollTop() > $body) {
                $(".redBag02").fadeIn();
            }
            else {
                $(".redBag02").fadeOut();
            }

        });
        //返回顶部
        $(".redBag02 a.a_top").on("click", function () {
            $(".city_fu_hui .outer").animate({
                scrollTop: 0
            }, 600);
        });

    }



    </script>

    <!--选择城市-->
    <!--微信分享-->
    <div class="sharePop w640 hide">
        <img src="http://m.525j.com.cn/images/share/share001.png">
    </div>
    <div class="wxshare hide"></div>
    <script src="http://m.525j.com.cn/js/wxshare.js"></script>
    <!--微信分享-->

    <script type="text/javascript">
        $(function () {
            $(".header").not(".norewriter").html("");
            $(".header").not(".norewriter").css({ "height": "2.68em", "background": "#cccccc", "border-bottom-color": "#cccccc" });
        });

    </script>
  
<script src="~/Scripts/page-resize.js"></script>
    <script type="text/javascript" src="http://m.525j.com.cn/js/cityjson.js"></script>
    <!-- 城市二级联动 -->
    <script type="text/javascript">
        function query(name) {
            return location.search.match(new RegExp('(?:\\?|&)' + name + '=(.*?)(?:$|&)', 'i')) ? decodeURIComponent(RegExp.$1) : '';
        }
        function getDtaByPid(pid){
            var ret = [];
            for( var i=0,len=cityJson.length;i<len;i++ ){
                if( cityJson[i].pid == pid ){
                    ret.push(cityJson[i]);
                }
            }
            return ret;
        }
        function fillData(parent,flag,pid){
            var html = "",
                address = getDtaByPid(pid);
            if( flag ){
                html += "<option>您的省份</option>";
            }
            for( var i=0,len=address.length;i<len;i++ ){
                html += "<option data-id='"+address[i].id+"' data-pid='"+address[i].pid+"'>"+address[i].text+"</option>";
            }
            parent.html(html);
        }
        function fillCity(){
            var province = $(".province select"),
                city = $(".city select");
            province.on("change",function(){
                var id = $(this).find("option:selected").data("id"),
                    text = $(this).find("option:selected").text();
                $(this).siblings("label").text(text);
                if( text=="您的省份" ){
                    city.html("<option>您的城市</option>");
                    city.siblings("label").text("您的城市");
                    return false;
                }
                if( text=="上海市"||text=="北京市" ){
                    city.html("<option data-id='"+id+"' data-pid='0'>"+text+"</option>");
                    city.siblings("label").text(text);
                    return false;
                }
                fillData(city,false,id);
                city.siblings("label").text(city.find("option").eq(0).text());
            });
            city.on("change",function(){
                var text = $(this).find("option:selected").text();
                $(this).siblings("label").text(text);
            });

        }
        function fillPrice(){
            var type=["2017暑期化学培训班", "2017暑期英语一对一外教"];
            var price = {
                "2017暑期化学培训班": ["1388", "1888", "2388"],
                "2017暑期英语一对一外教": ["699", "899", "1299", "1699"]
            };
            var selType=$(".level .select_type select"),
                selPrice=$(".level .select_price select");
            for (type in price){
                selType.append("<option value='"+type+"'>" + type + "</option>");
            }
            selType.on("change",function(){
                var $this=$(this);
                var text = $this.val();
                $this.siblings("label").text(text);
                var arr = price[text];
                selPrice.html("");
                $(arr).each(function(i, dom){
                    selPrice.append("<option value='"+dom+"'>" + dom + "元/㎡</option>");
                });
            });
        }
        function subMit(){
            var area_box = $("#area"),
                levelT_box = $(".select_type select"),
                levelP_box = $(".select_price select"),
                province_box = $(".province select"),
                city_box = $(".city select"),
                name_box = $(".name"),
                phone_box = $(".phone"),
                subBtn = $(".getBtn"),
                param = {},
                city = "shanghai",
                smsid=$(".baojia").data("smsid")||1000;
            var userSource = query("source");
            if (!userSource) userSource = "用户来自微站免费报价";
            subBtn.on("click",function(){
                param.area = area_box.val();
                param.level=levelT_box.val();
                param.price=levelP_box.val();
                param.province = province_box.find("option:selected").text();
                param.city = city_box.find("option:selected").text();
                param.name = name_box.val();
                param.phone = phone_box.val();

                if( param.area=="" ){
                    showMsg("请输入您的房屋面积");
                    return false;
                }
                if( param.province=="您的省份" ){
                    showMsg("请选择您所在的省份");
                    return false;
                }
                if( param.province=="您的城市" ){
                    showMsg("请选择您所在的城市");
                    return false;
                }
                if( param.name=="" ){
                    showMsg("请输入您的姓名");
                    return false;
                }
                if( !/^1[34578]\d{9}$/.test(param.phone) ){
                    showMsg("请输入正确的手机号码");
                    return false;
                }
                $(".shadow2").show();
                CorpApply.ApplyData(param.name,param.phone,userSource,"","",param.area,param.province+","+param.city+","+param.level+","+param.price,city,smsid,function(){
                        var nowprice = param.price;
                         $.getJSON("http://tu.525j.com.cn/ajax/smssend.ashx?jsoncallback=?", { phone: param.phone, price: (Number(nowprice)*(Number(param.area)<70?70:Number(param.area))).toString(),pkgtype: nowprice }, function (json) {
                                $(".shadow2").hide();
                                if (json.status == 200 ) {
                                    showMsg("已成功获取报价，请注意查收短信，谢谢！");
                                }
                         });
                });
            });
        }


        $(document).ready(function(){
            fillData($(".province select"),true,"0");//初始化省份
            fillCity();//城市联动
            subMit();
            fillPrice();

         
        });

    </script>


